import{a as R,O as w,u as H,i as L,w as S}from"./VAvatar-077f7042.js";import{p as $,q as b,H as C,r as M,C as q,x as c,m as z,c as B,v as D,B as F}from"./index-ecce79be.js";import{a as I}from"./getScrollParent-6bb6c202.js";function O(s){return Math.floor(Math.abs(s))*Math.sign(s)}const k=$({scale:{type:[Number,String],default:.5},...R()},"VParallax"),_=b()({name:"VParallax",props:k(),setup(s,g){let{slots:h}=g;const{intersectionRef:n,isIntersecting:r}=w(),{resizeRef:d,contentRect:i}=H(),{height:x}=C(),l=M();q(()=>{var t;n.value=d.value=(t=l.value)==null?void 0:t.$el});let e;c(r,t=>{t?(e=I(n.value),e=e===document.scrollingElement?document:e,e.addEventListener("scroll",a,{passive:!0}),a()):e.removeEventListener("scroll",a)}),z(()=>{e==null||e.removeEventListener("scroll",a)}),c(x,a),c(()=>{var t;return(t=i.value)==null?void 0:t.height},a);const u=B(()=>1-F(+s.scale));let m=-1;function a(){r.value&&(cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var f;const t=((f=l.value)==null?void 0:f.$el).querySelector(".v-img__img");if(!t)return;const v=e instanceof Document?document.documentElement.clientHeight:e.clientHeight,p=e instanceof Document?window.scrollY:e.scrollTop,y=n.value.getBoundingClientRect().top+p,o=i.value.height,P=y+(o-v)/2,V=O((p-P)*u.value),E=Math.max(1,(u.value*(v-o)+o)/o);t.style.setProperty("transform",`translateY(${V}px) scale(${E})`)}))}return L(()=>D(S,{class:["v-parallax",{"v-parallax--active":r.value},s.class],style:s.style,ref:l,cover:!0,onLoadstart:a,onLoad:a},h)),{}}});export{_ as V};
