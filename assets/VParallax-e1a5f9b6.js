import{a as S,z as V,u as N,i as H,k as L}from"./VImg-881afb73.js";import{p as b,l as M,a3 as R,r as C,a2 as D,V as i,k as T,c as Y,q as $,S as k}from"./index-7495cade.js";function z(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;e;){if(o?_(e):O(e))return e;e=e.parentElement}return document.scrollingElement}function O(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const o=window.getComputedStyle(e);return o.overflowY==="scroll"||o.overflowY==="auto"&&e.scrollHeight>e.clientHeight}function _(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const o=window.getComputedStyle(e);return["scroll","auto"].includes(o.overflowY)}function q(e){return Math.floor(Math.abs(e))*Math.sign(e)}const F=b({scale:{type:[Number,String],default:.5},...S()},"VParallax"),B=M()({name:"VParallax",props:F(),setup(e,o){let{slots:v}=o;const{intersectionRef:r,isIntersecting:l}=V(),{resizeRef:h,contentRect:u}=N(),{height:y}=R(),c=C();D(()=>{var n;r.value=h.value=(n=c.value)==null?void 0:n.$el});let t;i(l,n=>{n?(t=z(r.value),t=t===document.scrollingElement?document:t,t.addEventListener("scroll",a,{passive:!0}),a()):t.removeEventListener("scroll",a)}),T(()=>{t==null||t.removeEventListener("scroll",a)}),i(y,a),i(()=>{var n;return(n=u.value)==null?void 0:n.height},a);const m=Y(()=>1-k(+e.scale));let f=-1;function a(){l.value&&(cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var p;const n=((p=c.value)==null?void 0:p.$el).querySelector(".v-img__img");if(!n)return;const d=t instanceof Document?document.documentElement.clientHeight:t.clientHeight,g=t instanceof Document?window.scrollY:t.scrollTop,E=r.value.getBoundingClientRect().top+g,s=u.value.height,w=E+(s-d)/2,x=q((g-w)*m.value),P=Math.max(1,(m.value*(d-s)+s)/s);n.style.setProperty("transform",`translateY(${x}px) scale(${P})`)}))}return H(()=>$(L,{class:["v-parallax",{"v-parallax--active":l.value},e.class],style:e.style,ref:c,cover:!0,onLoadstart:a,onLoad:a},v)),{}}});export{B as V};
